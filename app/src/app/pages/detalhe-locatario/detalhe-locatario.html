<div class="grid grid-cols-5 gap-5">
    <p-card class="col-span-5" header="Dados do Locatário">
        <div class="flex justify-end mb-3">
            @if (!editandoLocatario) {
                <p-button label="Editar" icon="pi pi-pencil" (onClick)="entrarModoEdicaoLocatario()" 
                    severity="secondary" [outlined]="true"></p-button>
            } @else {
                <div class="flex gap-2">
                    <p-button label="Atualizar" icon="pi pi-check" (onClick)="salvarEdicaoLocatario()"></p-button>
                    <p-button label="Cancelar" icon="pi pi-times" (onClick)="cancelarEdicaoLocatario()" 
                        severity="secondary" [outlined]="true"></p-button>
                </div>
            }
        </div>
        
        @if (!editandoLocatario) {
            <!-- Modo Visualização -->
            <div class="grid grid-cols-2 gap-5">
                <div class="col-span-1">
                    <p class="text-sm text-gray-600 mb-1">Nome</p>
                    <p class="text-lg font-semibold">{{ locatario.nome }}</p>
                </div>
                <div class="col-span-1">
                    <p class="text-sm text-gray-600 mb-1">Telefone</p>
                    <p class="text-lg">{{ locatario.telefone }}</p>
                </div>
                <div class="col-span-1">
                    <p class="text-sm text-gray-600 mb-1">E-mail</p>
                    <p class="text-lg">{{ locatario.email }}</p>
                </div>
                <div class="col-span-1">
                    <p class="text-sm text-gray-600 mb-1">Imóvel</p>
                    <p class="text-lg">{{ selectedImovel?.endereco || 'Não informado' }}</p>
                </div>
            </div>
        } @else {
            <!-- Modo Edição -->
            <form [formGroup]="locatarioForm" (ngSubmit)="salvarEdicaoLocatario()">
                <div class="grid grid-cols-2 gap-5 mb-4">
                    <!-- Nome -->
                    <div class="col-span-1">
                        <label for="nome" class="block mb-2 text-sm font-medium">Nome</label>
                        <input 
                            pInputText 
                            id="nome" 
                            formControlName="nome" 
                            class="w-full"
                            [class.ng-invalid]="locatarioForm.get('nome')?.invalid && locatarioForm.get('nome')?.touched"
                        />
                        @if (locatarioForm.get('nome')?.invalid && locatarioForm.get('nome')?.touched) {
                            <small class="p-error">Nome é obrigatório</small>
                        }
                    </div>

                    <!-- Telefone -->
                    <div class="col-span-1">
                        <label for="telefone" class="block mb-2 text-sm font-medium">Telefone</label>
                        <p-inputNumber 
                            id="telefone" 
                            formControlName="telefone" 
                            [useGrouping]="false"
                            inputId="telefone"
                            class="w-full"
                            [class.ng-invalid]="locatarioForm.get('telefone')?.invalid && locatarioForm.get('telefone')?.touched"
                        />
                        @if (locatarioForm.get('telefone')?.invalid && locatarioForm.get('telefone')?.touched) {
                            <small class="p-error">Telefone é obrigatório</small>
                        }
                    </div>

                    <!-- Email -->
                    <div class="col-span-1">
                        <label for="email" class="block mb-2 text-sm font-medium">E-mail</label>
                        <input 
                            pInputText 
                            id="email" 
                            type="email"
                            formControlName="email" 
                            class="w-full"
                            [class.ng-invalid]="locatarioForm.get('email')?.invalid && locatarioForm.get('email')?.touched"
                        />
                        @if (locatarioForm.get('email')?.invalid && locatarioForm.get('email')?.touched) {
                            <small class="p-error">
                                @if (locatarioForm.get('email')?.errors?.['required']) {
                                    E-mail é obrigatório
                                } @else if (locatarioForm.get('email')?.errors?.['email']) {
                                    E-mail inválido
                                }
                            </small>
                        }
                    </div>

                    <!-- Imóvel -->
                    <div class="col-span-1">
                        <label for="aluguel_id" class="block mb-2 text-sm font-medium">Imóvel</label>
                        <p-autocomplete
                            fluid
                            inputId="aluguel_id"
                            formControlName="aluguel_id"
                            [suggestions]="filteredImoveis"
                            (completeMethod)="filterImoveis($event)"
                            optionLabel="endereco"
                            placeholder="Selecione ou digite um imóvel"
                            [style]="{ width: '100%' }"
                            [class.ng-invalid]="locatarioForm.get('aluguel_id')?.invalid && locatarioForm.get('aluguel_id')?.touched"
                            [forceSelection]="false"
                        />
                        @if (locatarioForm.get('aluguel_id')?.invalid && locatarioForm.get('aluguel_id')?.touched) {
                            <small class="p-error">Imóvel é obrigatório</small>
                        }
                    </div>
                </div>
            </form>
        }
    </p-card>
</div>

